<!DOCTYPE html>
<html ng-app="mittens" lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mittens</title>
  <!-- Download Bootstrap and moved the folder to app root, delete extension folder name -->
  <link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="bootstrap/css/style.css">
  <script src="angular.min.js" type="text/javascript"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/X.Y.Z/angular-route.js" type="text/javascript"></script>


<!-- Step 1: Initiate Angular app using ng-app in HTML tag and add angular.module -->
<!-- Module is a function, result of this function is "app" saved in var app -->
  <script type="text/javascript">
    var app = angular.module('mittens', ['ngRoute']);

    app.config(function($routeProvider, $locationProvider) {
      $routeProvider
      .when('/', {
        templateUrl: 'home.html',
        controller: 'HomeController',
      })
      .when('/signup', {
        templateUrl: 'signup.html',
        controller: 'SignupController',
      });
    });

    // $scope is an object/service.property(meows), it allows two-way data binding using {{}}
    app.controller('HomeController', function($scope, $http) {

      // The below code associated with ng-model below will record/submit to console (console.log($scope.newMeow), but instead, seding it to $http.post json)
      $scope.submitNewMeow = function() {
        $http.post('/meows', {newMeow: $scope.newMeow}).then(function() {
          getMeows();
          $scope.newMeow = '';
        });
      };

    // Using $scope.removeMeow instead of function.removeMeow bc need to call from front-end
      $scope.removeMeow = function(meow) {
        $http.put('/meows/remove', {meow: meow}).then(function() {
          getMeows();
        });
      };

    //// This block of code was moved from the front end to server.js to store in the database
      // $scope.meows = [
      //   'Hello, I flipped over a cup.',
      //   'My owner just said hi to me. Yum.',
      //   'It is time for a nap',
      //   'Hello again.',
      // ];

    //// Replaced block of code above w/ $scope.meows = response.data etc.

    // Callback function, that gets call when successfully gets meows from the server
      // $http is a service, .get is a function in that service (calls route meows).success is a promise (way to specify callback)
      function getMeows() {
        $http.get('/meows').then(function(response) {
          $scope.meows = response.data;

        });
      }
      getMeows();
    });

    app.controller('SignupController', function($scope, $http) {
      console.log('you\'re on the signup page');
    });


  </script>

</head>
<!-- Step 2: Initialize Angular controller -->
<body ng-controller="HomeController">
  <<div ng-view></div>

</body>
</html>
